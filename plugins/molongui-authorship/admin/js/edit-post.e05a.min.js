function addAuthorToList(e,t,a){e.append('<li data-value="'+t+'">'+a+'<input type="hidden" name="molongui_authors[]" value="'+t+'" /><span class="dashicons dashicons-trash molongui-tip js-remove" data-tip="'+authorship.remove_author_tip+'"></span></li>');jQuery(".molongui-tip").tipTip({attribute:"data-tip",fadeIn:50,fadeOut:50,delay:200})}function RenderAuthorOption(e){return(authorship.guest_enabled?["<div class='my-template'>",e.textContent,"<span class=''>",e.dataset.type,"</span>","</div>"]:["<div class='my-template'>",e.textContent,"</div>"]).join("")}function handleGuestQuickAdd(a,n){var u=jQuery("#molongui-add-guest-link"),l=jQuery("#molongui-add-guest-wrap"),e=jQuery("#molongui_new_guest_display_name"),t=jQuery("#molongui-add-btn"),r=jQuery("#molongui-cancel-btn");e.on("keypress",function(){jQuery(this).css("border-color","")}),u.on("click",function(){jQuery(this).parent().toggle(),l.toggle()}),r.on("click",function(){u.parent().toggle(),l.toggle()}),t.on("click",function(){if(0===e.val().trim().length)return e.css("border-color","red"),alert(authorship.guest_name_error),!1;var r=jQuery(this),o=jQuery(this).html();jQuery(this).html('<div class="m-typing-loader"></div>'),jQuery.ajax({url:ajaxurl,type:"POST",data:{action:"quick_add_guest_author",display_name:e.val(),nonce:jQuery("#molongui_authorship_quick_add_nonce").val()},success:function(e){var t=JSON.parse(e);t.error?(alert(authorship.ajax_fn_error),r.html(o)):(n.add({value:t.guest_ref,text:t.guest_name}),a.length?addAuthorToList(a,t.guest_ref,t.guest_name):n.setValue(t.guest_ref),r.html(o),u.parent().toggle(),l.toggle())},error:function(e,t,a){alert(authorship.ajax_call_error),r.html(o)}})})}jQuery.molonguiInitAuthorSelector=function(e,r,t){if(e){var o=r.length,n=new MolonguiSelectr(e,{defaultSelected:!1,allowDeselect:o,clearable:o,placeholder:t.trim()?t:authorship.select_author_tip.trim()?authorship.select_author_tip:o?"Select an(other) author...":"Select an author",renderOption:RenderAuthorOption,messages:{noOptions:"No authors available",noResults:"No authors found",searchPlaceholder:"Find author by name..."}});if(jQuery(".selectr-input-container input.selectr-input").attr("placeholder","Find author by name..."),o&&(n.on("selectr.select",function(e){var t=n.getValue(!0);0===r.find("li[data-value="+t.value+"]").length&&addAuthorToList(r,t.value,t.text),n.clear();var a=authorship.select_author_tip.trim()?authorship.select_author_tip:o?"Select an(other) author...":"Select an author";jQuery(".selectr-placeholder").html(a)}),void 0!==r))var a=Sortable.create(r[0],{filter:".js-remove",onFilter:function(e){jQuery("#tiptip_holder").css("display","none");var t=a.closest(e.item);t&&t.parentNode.removeChild(t)}});return n}},jQuery(document).ready(function(e){var t=document.getElementById("_molongui_author"),a=e("ul#molongui_authors");handleGuestQuickAdd(a,e.molonguiInitAuthorSelector(t,a,""))});